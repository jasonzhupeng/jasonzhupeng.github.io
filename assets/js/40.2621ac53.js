(window.webpackJsonp=window.webpackJsonp||[]).push([[40],{479:function(s,a,t){"use strict";t.r(a);var e=t(2),r=Object(e.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("p",[s._v("Linux安装MySQL的方式有多种，为了"),a("strong",[s._v("加深理解和自定义安装目录")]),s._v("，此文将演示使用源码编译的方式在Linux服务器安装MySql数据库，由于我的服务器已经安装了MySql，版本是"),a("code",[s._v("5.7.38")]),s._v("。所以为了演示，我要先将原先的数据库备份，再卸载再重装...")]),s._v(" "),a("h2",{attrs:{id:"备份和卸载数据库"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#备份和卸载数据库"}},[s._v("#")]),s._v(" 备份和卸载数据库")]),s._v(" "),a("p",[s._v("编写语句备份数据库，-B 备份整个数据库包含，创建语句")]),s._v(" "),a("div",{staticClass:"language-sql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[s._v("mysqldump "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("h localhost "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("u root "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("p "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("--all-databases > /home/mysql_bak/#{DATE}.sql  --备份全库")]),s._v("\nmysqldump "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("h localhost "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("u root "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("p "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("B testdb "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("home"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("mysql_bak"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("testdb"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("sql")]),s._v("\nmysqldump "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("h localhost "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("u root "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("p "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("B testdb1 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("home"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("mysql_bak"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("testdb1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("sql")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("卸载MySql，先停止再删除mysql服务")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[s._v("systemctl stop mysql    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#服务方式")]),s._v("\nmysqladmin "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-u")]),s._v(" root "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("shutdown")]),s._v("     "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#命令方式 ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" /etc/rc.d/init.d/mysqld\nsystemctl daemon-reload\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("如果是使用rpm或yum包管理工具方式安装的，则先看安装状态，运行命令")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rpm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-qa")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-i")]),s._v(" mysql \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#...或 ")]),s._v("\nyum list installed "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" mysql\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("如果有结果输出则表示已安装，通过运行命令卸载")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rpm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-e")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--nodeps")]),s._v(" mysql*  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#强力删除，--nodeps 一并删除依赖文件")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#...或")]),s._v("\nyum remove "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-y")]),s._v(" mysql*\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("p",[s._v("查找对应mysql文件，并删除")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("find")]),s._v(" / "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-name")]),s._v(" mysql\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("find")]),s._v(" / "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-name")]),s._v(" mysql "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("xargs")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-rf")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#删除")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("通过以上操作，mysql卸载完成")]),s._v(" "),a("h2",{attrs:{id:"下载mysql源码包"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#下载mysql源码包"}},[s._v("#")]),s._v(" 下载MySql源码包")]),s._v(" "),a("p",[s._v("1.mysql官方下载地址："),a("a",{attrs:{href:"https://dev.mysql.com/downloads/mysql/",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://dev.mysql.com/downloads/mysql/"),a("OutboundLink")],1),s._v("，选择对应的版本下载到本地。")]),s._v(" "),a("p",[a("mark",[s._v("注意源码有2个版本可选择，由于mysql从5.7版本开始便依赖boost库，所以有包含boost版和不包含boost版；如果选择不包含boost则预编译的时候需要单独安装boost，第一次安装推荐选择包含boost版。")])]),s._v(" "),a("p",[s._v("boost官方下载地址："),a("a",{attrs:{href:"https://sourceforge.net/projects/boost/files/boost/",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://sourceforge.net/projects/boost/files/boost/"),a("OutboundLink")],1),s._v(" "),a("img",{attrs:{src:s.$withBase("/images/database/wx_0518_01.png")}}),s._v("\n将源码包上传到服务器"),a("code",[s._v("/usr/local/src")]),s._v("目录")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[s._v("scp ./mysql-5.7.38.tar.gz root@119.23.233.64:/usr/local/src\n")])])]),a("p",[s._v("2.或者使用命令直接下载到服务器")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[s._v("cd /usr/local/src\nwget https://downloads.mysql.com/archives/get/p/23/file/mysql-5.7.38.tar.gz\n")])])]),a("h2",{attrs:{id:"编译源码包-并安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#编译源码包-并安装"}},[s._v("#")]),s._v(" 编译源码包，并安装")]),s._v(" "),a("p",[s._v("解压压缩文件")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[s._v("tar -xzvf mysql-5.7.38.tar.gz\n")])])]),a("p",[s._v("安装编译工具")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[s._v("yum -y install make cmake gcc gcc-c++ ncurses ncurses-devel libaio libaio-devel\n")])])]),a("p",[s._v("创建mysql安装目录、数据库存放目录、日志目录")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[s._v("mkdir -p /usr/local/webserver/mysql\nmkdir -p /usr/local/webserver/mysql/data\nmkdir -p /usr/local/webserver/mysql/logs\nmkdir -p /usr/local/webserver/mysql/binlog\n")])])]),a("p",[s._v("进入到MySQL的源码目录，预编译，配置安装目录")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /usr/local/src/mysql-5.7.38\n\ncmake "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-DCMAKE_INSTALL_PREFIX")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/webserver/mysql "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-DMYSQL_DATADIR")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/webserver/mysql/data "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-DSYSTEMD_PID_DIR")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/webserver/mysql "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-DMYSQL_UNIX_ADDR")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/usr/local/webserver/mysql/mysql.sock "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-DSYSCONFDIR")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("/etc "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-DDEFAULT_CHARSET")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("utf8  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-DDEFAULT_COLLATION")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("utf8_general_ci "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-DEXTRA_CHARSETS")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("all "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-DWITH_INNOBASE_STORAGE_ENGINE")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-DWITH_MYISAM_STORAGE_ENGINE")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-DWITH_MEMORY_STORAGE_ENGINE")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-DWITH_BOOST")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("boost\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# -DWITH_SYSTEMD=1")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br")])]),a("p",[s._v("参数说明：")]),s._v(" "),a("ul",[a("li",[s._v("-DCMAKE_INSTALL_PREFIX=/usr/local/mysql      "),a("font",{attrs:{color:"red"}},[s._v("指定安装目录")])],1),s._v(" "),a("li",[s._v("-DINSTALL_DATADIR=/usr/local/mysql/data      "),a("font",{attrs:{color:"red"}},[s._v("指定数据库存放目录")])],1),s._v(" "),a("li",[s._v("-DDEFAULT_CHARSET=utf8                       "),a("font",{attrs:{color:"red"}},[s._v("使用utf8字符")])],1),s._v(" "),a("li",[s._v("-DDEFAULT_COLLATION=utf8_general_ci          "),a("font",{attrs:{color:"red"}},[s._v("校验字符")])],1),s._v(" "),a("li",[s._v("-DWITH_SYSTEMD    "),a("font",{attrs:{color:"red"}},[s._v("决定是否安装mysqld_safe")])],1)]),s._v(" "),a("p",[s._v("预编译报错通常是因为缺少依赖的包造成的，把缺少的包安装上再重新进行编译。\n"),a("img",{attrs:{src:s.$withBase("/images/database/wx_0518_02.png")}}),s._v("\n如上错误是boost位置错误导致改为正确位置：-DWITH_BOOST=../boost，再重新预编译，重新编译时，需要清除旧的对象文件和缓存信息")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[s._v("make clean \\\nrm -f CMakeCache.txt\n")])])]),a("p",[s._v("运行命令，正式编译并安装，此过程一般比较久，请耐心等待")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[s._v("make && make install\n")])])]),a("p",[s._v("经过以上操作，编译安装完成。")]),s._v(" "),a("h2",{attrs:{id:"配置mysql"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置mysql"}},[s._v("#")]),s._v(" 配置MySql")]),s._v(" "),a("p",[s._v("进入/etc目录编辑my.cnf文件（windows系统下为my.ini），如果没有my.cnf文件则新建此文件")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("touch")]),s._v(" /etc/my.cnf\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /etc/my.cnf\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("client"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nport "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3306")]),s._v("\nsocket "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /usr/local/webserver/mysql/mysql.sock\n \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("mysql"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nport "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3306")]),s._v("\ndefault-character-set "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" utf8\nsocket "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /usr/local/webserver/mysql/mysql.sock\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("mysqld"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nuser "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" mysql\nport "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3306")]),s._v("\ncharacter_set_server "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" utf8\ndefault-storage-engine "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" INNODB\n\npid-file "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /usr/local/webserver/mysql/mysqld.pid\nbasedir "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /usr/local/webserver/mysql\ndatadir "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /usr/local/webserver/mysql/data\nsocket "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /usr/local/webserver/mysql/mysql.sock\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#免密登录，用于忘记root密码，重置密码时使用")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#skip-grant-tables")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#log_output = FILE")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 二进制日志")]),s._v("\nserver-id "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\nbinlog-format "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" ROW\nlog_bin "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /usr/local/webserver/mysql/logs/binlog "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 二进制日志名称")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 错误日志")]),s._v("\nlog_error "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /usr/local/webserver/mysql/logs/error.log\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 常规查询日志")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#general_log = 0")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#general_log_file = /usr/local/webserver/mysql/logs/general.log")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 慢查询日志")]),s._v("\nslow_query_log "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\nslow_query_log_file "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" /usr/local/webserver/mysql/logs/slow.log\nlong_query_time "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("mysqldump"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nquick\nmax_allowed_packet "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" 32M\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br")])]),a("p",[s._v("配置环境变量")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[s._v("echo 'export MYSQLPATH=/usr/local/webserver/mysql' >> /etc/profile\necho 'export PATH=$MYSQLPATH/bin:$MYSQLPATH/lib:$PATH' >> /etc/profile\nsource /etc/profile\n")])])]),a("p",[s._v("增加权限，不然日志无法写入")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[s._v("chown mysql:mysql /etc/my.cnf\nchown -R mysql:mysql /usr/local/webserver/mysql\nchmod 770 -R /usr/local/webserver/mysql\n")])])]),a("p",[s._v("初始化数据库命令")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[s._v("mysqld --initialize --user=mysql\n")])])]),a("p",[s._v("初始化成功后，可以在输出日志，或者"),a("code",[s._v("logs/error.log")]),s._v("日志里面找到root管理员的初始密码\n"),a("img",{attrs:{src:s.$withBase("/images/database/wx_0522_01.png")}})]),s._v(" "),a("p",[s._v("创建MySQL服务")]),s._v(" "),a("div",{staticClass:"language-sh line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /usr/local/webserver/mysql\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" support-files/mysql.server /etc/rc.d/init.d/mysqld \n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chkconfig")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--add")]),s._v(" mysqld\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chkconfig")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--level")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("35")]),s._v(" mysqld on  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#设置开机启动")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("启动MySQL服务")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[s._v("systemctl start mysql\nsystemctl status mysql\n")])])]),a("p",[s._v("出现如下界面，说明MySQL已经安装完成，并部署成功...\n"),a("img",{attrs:{src:s.$withBase("/images/database/wx_0522_02.png")}})]),s._v(" "),a("h2",{attrs:{id:"连接mysql"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#连接mysql"}},[s._v("#")]),s._v(" 连接MySQL")]),s._v(" "),a("p",[s._v("通过以上操作成功将mysql数据库安装到服务器，接下来我们在服务器用mysql客户端连接数据库，进行root管理员的配置\n"),a("img",{attrs:{src:s.$withBase("/images/database/wx_0522_03.png")}}),s._v(" "),a("mark",[s._v("首次登录，必须先修改root的初始秘密才能进行其他操作")]),s._v(" "),a("img",{attrs:{src:s.$withBase("/images/database/wx_0522_04.png")}})]),s._v(" "),a("div",{staticClass:"language-sql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("alter")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("user")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root'")]),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("@'localhost'")]),s._v(" identified "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("by")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'xxxxx'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("设置数据库允许远程登录")]),s._v(" "),a("div",{staticClass:"language-sql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-sql"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("update")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("user")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("set")]),s._v(" host "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'%'")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("where")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("user")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'root'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\nflush "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("privileges")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("再使用客户端连接工具测试，是否能连接到数据库\n"),a("img",{attrs:{src:s.$withBase("/images/database/wx_0522_05.png")}})]),s._v(" "),a("p",[s._v("客户端连接成功，可以看到系统数据库，并查询到数据\n"),a("img",{attrs:{src:s.$withBase("/images/database/wx_0522_06.png")}}),s._v("\n以上就是，在Linux服务器使用源码方式安装MySQL数据库，的全部步骤")]),s._v(" "),a("h2",{attrs:{id:"还原备份"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#还原备份"}},[s._v("#")]),s._v(" 还原备份")]),s._v(" "),a("p",[s._v("最后需要将之前备份的数据库进行还原")]),s._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[s._v("mysql -h localhost -u root -p < testdb.sql")])])])])}),[],!1,null,null,null);a.default=r.exports}}]);